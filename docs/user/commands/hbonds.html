<html>

<!--
=== UCSF ChimeraX Copyright ===
Copyright 2016 Regents of the University of California.
All rights reserved.  This software provided pursuant to a
license agreement containing restrictions on its disclosure,
duplication and use.  For details see:
http://www.rbvi.ucsf.edu/chimerax/docs/licensing.html
This notice must be embedded in or attached to all copies,
including partial copies, of the software or any revisions
or derivations thereof.
=== UCSF ChimeraX Copyright ===
-->

<head>
<link rel="stylesheet" type="text/css" href="../userdocs.css" />
<title>Command: hbonds</title>
</head><body>

<a name="top"></a>
<a href="../index.html">
<img width="60px" src="../ChimeraX-docs-icon.svg" alt="ChimeraX docs icon"
class="clRight" title="User Guide Index"/></a>

<h3><a href="../index.html#commands">Command</a>: hbonds</h3>
<h3><a href="usageconventions.html">Usage</a>:
<br><b>hbonds</b> 
[&nbsp;<b>color</b>&nbsp;&nbsp;<a href="colornames.html"><i>colorname</i></a>&nbsp;]
[&nbsp;<b>radius</b>&nbsp;&nbsp;<i>r</i>&nbsp;]
[&nbsp;<b>selRestrict</b>&nbsp;&nbsp;<a href="atomspec.html"><i>atom-spec</i></a>&nbsp;|&nbsp;cross&nbsp;|&nbsp;both&nbsp;|&nbsp;any&nbsp;]
&nbsp;<a href="#options"><i>other-options</i></a></h3>
<h3><a href="usageconventions.html">Usage</a>:
<br><b>~hbonds</b> 
</h3>
<p>
The <b>hbonds</b> command uses <a href="../atomtypes.html">atom types</a> and
<a href="#criteria">geometric criteria</a>
to identify possible hydrogen bonds (H-bonds).
By <a href="#makePseudobonds">default</a>, 
the H-bonds are shown as dashed <a href="../pseudobonds.html">pseudobonds</a>
that can be removed with <b>~hbonds</b>.
The pseudobond <b>color</b> and <b>radius</b> can be specified.
The <b>selRestrict</b> option allows limiting detection to only the 
<a href="../selection.html">selected</a> atoms or between the 
<a href="../selection.html">selected</a> atoms and another set of atoms
(<a href="#selRestrict">details...</a>).
The total number of H-bonds found is reported in the
<a href="../tools/log.html"><b>Log</b></a>. The total includes all H-bonds
consistent with the criteria, even if they could not coexist simultaneously.
Distances and other details can be <a href="#log">logged</a>
and/or <a href="#saveFile">saved</a> to a file.
</p><p>
The command-line specifier
<a href="atomspec.html#builtin"><b>hbonds</b></a>
(not to be confused with the command)
refers to H-bond pseudobonds and their endpoint atoms.
</p>

<a name="options"></a>
<h4>Options</h4>
<p>
Option keywords and Boolean (truth) values can be truncated, with
synonyms for true: True, 1, and synonyms for false: False, 0.
A vertical bar &ldquo;|&rdquo; designates mutually exclusive values, and
default settings are indicated with <b>bold</b>.
</p>
<blockquote>
<a name="makePseudobonds"><b>makePseudobonds</b> &nbsp;<b>true</b>&nbsp;|&nbsp;false
</a>
<br>Whether to show the H-bonds in 3D by creating a
<a href="../pseudobonds.html">pseudobond model</a>
named <b>hydrogen bonds</b>. The pseudobonds will be drawn
between the donor and acceptor atoms, or if hydrogens are present,
between the hydrogens and acceptor atoms. 
H-bond pseudobonds are only displayed when both endpoint atoms are displayed,
but the <a href="#reveal"><b>reveal</b></a> option can be used to ensure 
all H-bonds are displayed by displaying the associated residues.
For purposes of pseudobond display, backbone atoms are considered as displayed 
when their display is being
<a href="cartoon.html#suppress">suppressed</a> by cartoon (ribbon).
<p>
The number of H-bonds found may exceed the apparent number of pseudobonds 
because the same pair of atoms could be identified as both
donor-acceptor and acceptor-donor, even if only one of those 
interactions could form at a time.
<!-- example: 1zik HOH residues 50,53 which could be both at same time -->
</p>
</blockquote>
<blockquote>
  <b>color</b> &nbsp;<i>colorname</i>
<br>Color to use for <a href="../pseudobonds.html">pseudobonds</a>
depicting H-bonds (but see also <a href="#twoColors"><b>twoColors</b></a>
and <a href="#slopColor"><b>slopColor</b></a>).
The <i>colorname</i> can be any <a href="colornames.html">color name</a>
that specifies a single color (default <b>dark cyan</b>).
Subsequent recoloring without recalculating the H-bonds can be done with 
the <a href="color.html"><b>color</b></a> command, for example:
<b>color <a href="atomspec.html#builtin">hbonds</a> goldenrod target p</b>
</blockquote>
<blockquote>
  <b>radius</b> &nbsp;<i>r</i>
<br>Radius in &Aring; to use for <a href="../pseudobonds.html">pseudobonds</a>
depicting H-bonds (default <b>0.075</b>);
can be changed later with <a href="style.html"><b>style</b></a>.
</blockquote>
<blockquote>
  <b>dashes</b> &nbsp;<i>N</i>
<br>Number of dashes to use for <a href="../pseudobonds.html">pseudobonds</a>
depicting H-bonds (default <b>6</b>).
Only whole numbers are accepted, with 0
indicating solid sticks. Currently, odd numbers are rounded down
to give an even number of dashes. The number of dashes
can be changed later with <a href="style.html"><b>style</b></a>.
</blockquote>
<blockquote>
<font color="brown">
Not yet implemented:<br>
  <a name="showDist"><b>showDist</b> &nbsp;true&nbsp;|&nbsp;<b>false</b></a>
<br>Whether to label the <a href="../pseudobonds.html">pseudobonds</a>
with the corresponding distances.
</font>
</blockquote>
<blockquote>
<a name="selRestrict"><b>selRestrict</b></a>
&nbsp;<a href="atomspec.html"><i>atom-spec</i></a>&nbsp;|&nbsp;cross&nbsp;|&nbsp;both&nbsp;|&nbsp;any
<br>Whether to limit H-bond detection to one of the following:
<ul>
<li>those between atoms in
<a href="atomspec.html"><i>atom-spec</i></a>
and the current <a href="../selection.html">selection</a>;
the specified atoms and the selection may overlap, but
<a href="atomspec.html"><i>atom-spec</i></a>
will not overrule other restrictions (for example, if
the specified atoms are in a different model than the selected atoms
but <a href="#intermodel"><b>intermodel</b></a> is <b>false</b>,
no H-bonds will be found).
<li><b>cross</b> - H-bonds with exactly one atom
<a href="../selection.html">selected</a>
<li><b>both</b> - H-bonds with both atoms
<a href="../selection.html">selected</a>
<li><b>any</b> - H-bonds with at least one atom
<a href="../selection.html">selected</a>
</ul>
This option is <b>off</b> unless specified.
<blockquote>
</blockquote>
  <b>spec</b>
  &nbsp;<a href="atomspec.html"><i>atom-spec</i></a>
<br>Whether to restrict H-bond detection to a subset of
the open molecule models. The <i>entire model(s)</i> containing
the specified atoms will be considered.
</blockquote>
<blockquote>
  <b>interSubmodel</b> &nbsp;true&nbsp;|&nbsp;<b>false</b>
<br>Whether to look for H-bonds between
<a href="atomspec.html#hierarchy">submodels</a> of the same model.
</blockquote>
<blockquote>
  <a name="intermodel"><b>interModel</b></a> &nbsp;<b>true</b>&nbsp;|&nbsp;false
<br>Whether to look for H-bonds between models.
</blockquote>
<blockquote>
  <b>intraModel</b> &nbsp;<b>true</b>&nbsp;|&nbsp;false
<br>Whether to look for H-bonds within models.
</blockquote>
<blockquote>
  <b>intraMol</b> &nbsp;<b>true</b>&nbsp;|&nbsp;false
<br>Whether to include intramolecular H-bonds,
where a molecule is defined as a covalently bonded set of atoms.
</blockquote>
<blockquote>
  <b>intraRes</b> &nbsp;<b>true</b>&nbsp;|&nbsp;false
<br>Whether to include intraresidue H-bonds.
</blockquote>
<blockquote>
  <a name="cacheDA"><b>cacheDA</b> &nbsp;true&nbsp;|&nbsp;false</a>
<br>Whether to cache and reuse donor and acceptor information
rather than regenerating it each time the command is used;
useful for calculations on different conformations of the same structure.
The default is <b>true</b> for a <a href="../trajectories.html">trajectory</a>, 
otherwise <b>false</b>.
</blockquote>
<blockquote>
  <a name="relax"><b>relax</b> &nbsp;<b>true</b>&nbsp;|&nbsp;false</a>
<br>Whether to relax the
<a href="#criteria">precise criteria</a> for hydrogen bonding.
</blockquote>
<a name="tolerances"></a>
<blockquote>
  <b>distSlop</b> &nbsp;<i>tolerance</i>
<br>How much to relax the distance criteria if
<a href="#relax"><b>relax</b></a> is <b>true</b>;
<i>tolerance</i> is <b>0.4</b> &Aring; by default.
</blockquote>
<blockquote>
  <b>angleSlop</b> &nbsp;<i>tolerance</i>
<br>How much to relax the angle criteria if
<a href="#relax"><b>relax</b></a> is <b>true</b>;
<i>tolerance</i> is <b>20.0</b> degrees by default.
</blockquote>
<blockquote>
  <a name="twoColors"><b>twoColors</b> &nbsp;true&nbsp;|&nbsp;<b>false</b></a>
<br>Whether to use different colors for H-bonds meeting and not
meeting the precise criteria (<i>i.e.</i>, whether a different color
should be used for H-bonds outside the precise criteria but within
the tolerance values).
</blockquote>
<blockquote>
  <a name="slopColor"><b>slopColor</b> &nbsp;<i>colorname</i></a>
<br>If <a href="#twoColors"><b>twoColors</b></a>
is <b>true</b>, the color to use for H-bonds not meeting the 
precise criteria but within the tolerance values. 
The <i>colorname</i> can be any <a href="colornames.html">color name</a> 
that specifies a single color (default <b>dark orange</b>).
</blockquote>
<blockquote>
<a name="reveal"><b>reveal</b> &nbsp;true&nbsp;|&nbsp;<b>false</b></a>
<br>Whether to turn on the display of residues containing an
H-bonding atom if that atom is not displayed initially.
(By default, if the atom on either end of a
<a href="../pseudobonds.html">pseudobond</a> representing
an H-bond is not shown, the pseudobond itself is not shown, although
it still exists; displaying the atom allows the H-bond to be shown.)
</blockquote>
<blockquote>
  <b>retainCurrent</b> &nbsp;true&nbsp;|&nbsp;<b>false</b>
<br>Whether to keep the <a href="../pseudobonds.html">pseudobonds</a>
depicting a previously determined set of H-bonds through a subsequent
round of detection (as opposed to replacing the old with the new).
</blockquote>
<blockquote>
  <a name="saveFile"><b>saveFile</b> &nbsp;<i>file</i></a>
<br>Save H-bond information to a file.
The information includes donor and acceptor atom specifications
(see <a href="#namingStyle"><b>namingStyle</b></a>),
donor-acceptor distances, and when hydrogens are present,
hydrogen atom specifications and hydrogen-acceptor distances.
<i>File</i> is the output file name/pathname; 
if it includes spaces, it must be enclosed in quotation marks.
</blockquote>
<blockquote>
  <a name="log"><b>log</b> &nbsp;true&nbsp;|&nbsp;<b>false</b></a>
<br>Whether to write H-bond information (as described above for
<a href="#saveFile"><b>saveFile</b></a>) to the
<a href="../tools/log.html"><b>Log</b></a>.
</blockquote>
<blockquote>
  <a name="namingStyle"><b>namingStyle</b> &nbsp;simple&nbsp;|&nbsp;command&nbsp;|&nbsp;serial</a>
<br>How to describe atoms in H-bond information
written to a <a href="#saveFile">file</a> or the <a href="#log">log</a>:
<ul>
<li><b>simple</b> - chain ID (preceded by slash), 
residue name, residue number, atom name (for example, /B ASN 21 OD1)
<li><b>command</b>
- <a href="atomspec.html#hierarchy">command-line specifier</a>
(for example, /B:21@OD1)
<li><b>serial</b> - atom serial number
(for example, 126)
</ul>
Model number will be included when multiple models are present.
</blockquote>
<blockquote>
  <b>batch</b> &nbsp;true&nbsp;|&nbsp;<b>false</b>
<br>Whether to suppress certain errors; useful for no-GUI
batch processing.  Currently, the only error suppressed when
<b>batch</b> is <b>true</b> is that which arises if no atoms are
<a href="../selection.html">selected</a>
when <a href="#selRestrict"><b>selRestrict</b></a> is specified.
</blockquote>

<a name="criteria"></a>
<h4>Method and Geometric Criteria</h4>
<p>
Distance and angle cutoffs for H-bonding
are based on a survey of small-molecule crystal structures, as described in
<blockquote>
<a href="http://www.ncbi.nlm.nih.gov/pubmed/9007693" target="_blank">
Three-dimensional hydrogen-bond geometry and probability information
from a crystal survey.</a>
Mills JE, Dean PM.
<i>J Comput Aided Mol Des.</i> 1996 Dec;10(6):607-22.
</blockquote>
There are many different sets of geometric
criteria, corresponding to the many different donor-acceptor combinations
(see Tables 5-8 in the reference).
There is an upper bound on distance and one or more
angular range criteria for each category of H-bond.
It is generally useful to relax the criteria since most structures
are not as high-resolution as those used in the survey.
User-specified <a href="#tolerances">tolerances</a>
are added to each criterion's upper bound and/or subtracted from
its lower bound (depending on the particular criterion).
</p><p>
Chimera uses atom and residue names, or if these are not &ldquo;standard,&rdquo;
the coordinates of atoms, to determine connectivity and
<a href="../atomtypes.html">atom types</a>,
which in turn determine which geometric criteria are appropriate for
detecting a hydrogen bond between specific atoms.
Possible donor groups are hydrogen-bearing nitrogen, oxygen, and sulfur atoms,
and possible acceptor groups are nitrogen, oxygen, and sulfur atoms
with a lone pair.  H-bonds involving other types of atoms are not considered.
Not all of the possible donor-acceptor combinations were listed
in the Mills and Dean parameter tables; some categories of sulfur
were not surveyed, and several combinations of the surveyed types
were not observed frequently enough to collect good statistics on their
geometries.  In such cases, <b>FindHbond</b>
applies estimated H-bond criteria.
</p><p>
When there are no explicit hydrogens on a potential donor atom,
<b>FindHBond</b> will use the donor
<a href="../atomtypes.html">atom type</a> to infer their presence.
For functional groups where the hydrogen
positions are well-determined by the positions of the nonhydrogen atoms,
the H-bonds detected in the presence and absence of explicit hydrogen
atoms should be virtually identical.  For functional groups where the
hydrogen position is not well-determined (such as rotatable hydroxyls),
the presence of an explicit hydrogen atom will limit the detected
H-bonds to those appropriate for the observed position, instead of
all of its possible positions.
</p>

<hr>
<address>UCSF Resource for Biocomputing, Visualization, and Informatics /
June 2017</address>
</body></html>
