<html>

<!--
=== UCSF ChimeraX Copyright ===
Copyright 2016 Regents of the University of California.
All rights reserved.  This software provided pursuant to a
license agreement containing restrictions on its disclosure,
duplication and use.  For details see:
http://www.rbvi.ucsf.edu/chimerax/docs/licensing.html
This notice must be embedded in or attached to all copies,
including partial copies, of the software or any revisions
or derivations thereof.
=== UCSF ChimeraX Copyright ===
-->

<head>
<link rel="stylesheet" type="text/css" href="../userdocs.css" />
<title>Command: hbonds</title>
</head><body>

<a name="top"></a>
<a href="../index.html">
<img width="60px" src="../ChimeraX-docs-icon.svg" alt="ChimeraX docs icon"
class="clRight" title="User Guide Index"/></a>

<h3><a href="../index.html#commands">Command</a>: hbonds</h3>
<h3><a href="usageconventions.html">Usage</a>:
<br><b>hbonds</b> 
&nbsp;&nbsp;<a href="atomspec.html"><i>atom-spec1</i></a>&nbsp;
[&nbsp;<b>saltOnly</b>&nbsp;&nbsp;true&nbsp;|&nbsp;<b>false</b>&nbsp;]
[&nbsp;<b>restrict</b>&nbsp;&nbsp;cross&nbsp;|&nbsp;both&nbsp;|&nbsp;any&nbsp;|&nbsp;&nbsp;<a href="atomspec.html"><i>atom-spec2</i></a>&nbsp;]
[&nbsp;<b>color</b>&nbsp;&nbsp;<a href="colornames.html"><i>colorname</i></a>&nbsp;]
[&nbsp;<b>radius</b>&nbsp;&nbsp;<i>r</i>&nbsp;]
[&nbsp;<b>dashes</b>&nbsp;&nbsp;<i>N</i>&nbsp;]
[&nbsp;<b>name</b> &nbsp;<i>name</i>&nbsp;]
[&nbsp;<b>reveal</b>&nbsp;&nbsp;true&nbsp;|&nbsp;<b>false</b>&nbsp;]
&nbsp;<a href="#options"><i>other-options</i></a></h3>
<h3><a href="usageconventions.html">Usage</a>:
<br><b>~hbonds</b> 
[&nbsp;<b>name</b> &nbsp;<i>name</i>&nbsp;]
</h3>
<p>
The <b>hbonds</b> command uses <a href="../atomtypes.html">atom types</a> and
<a href="#criteria">geometric criteria</a> to identify hydrogen bonds (H-bonds)
involving the specified atoms.
The <b>saltOnly</b> option allows finding just the 
<a href="#saltOnly">salt bridges</a>,
and the <b>restrict</b> option allows finding only H-bonds within the specified 
set of atoms or between them and a second set (<a href="#restrict">details...</a>).
The total number of H-bonds found is reported in the
<a href="../tools/log.html"><b>Log</b></a>. The total includes all H-bonds
consistent with the criteria, even if they could not coexist simultaneously.
Distances and other details can be <a href="#log">logged</a>
and/or <a href="#saveFile">saved</a> to a file.
</p><p>
By <a href="#makePseudobonds">default</a>, 
the H-bonds are shown as dashed <a href="../pseudobonds.html">pseudobonds</a>.
Their <b>color</b>, <b>radius</b>, and number of <b>dashes</b> can be 
specified. The pseudobonds can be removed with the <b>~hbonds</b> command.
The default <a href="#name">name</a> of the pseudobond model(s) for creation
(and for removal with the <b>~hbonds</b> command) is <b>hydrogen bonds</b>,
but different names can be assigned and used.
When multiple pseudobond models have the same name, specific models can be 
removed with the <a href="close.html"><b>close</b></a> command.
</p><p>
Pseudobonds are only shown if their endpoint atoms are shown;
<b>reveal true</b> can be used to display all involved residues 
so that all of the H-bonds will be shown (<a href="#reveal">details...</a>).
Since a backbone atom is considered as shown when its cartoon is
<a href="cartoon.html#suppress">suppressing</a> the backbone atoms,
a pseudobond (which goes the atom position) may appear to be floating in space. 
Floating pseudobonds can be hidden with the command
<b><a href="cartoon.html">cartoon suppress false</a></b>,
with the side effect of showing any backbone atoms that were already
displayed but suppressed.
</p><p>
<a name="examples">Examples:</a>
<blockquote>
<b><a href="show.html">hide</a><br>hb ligand restrict protein reveal true</b>
</blockquote>
&ndash; hide all atoms, then identify H-bonds between 
<a href="atomspec.html#builtin"><b>ligand</b></a> and
<a href="atomspec.html#builtin"><b>protein</b></a>,
displaying the residues involved; note that the automatic classifier
<a href="atomspec.html#builtin"><b>ligand</b></a> may not specify exactly
(or only) the atoms of interest, and in that case, residue names, numbers, and/or
chain IDs may be used instead, as in the following example:
<blockquote>
<b>hb /a:nad restrict cross log true reveal true</b>
</blockquote>
&ndash; calculate H-bonds between the NAD residue in chain A and everything else,
write results to the <a href="../tools/log.html"><b>Log</b></a>
<blockquote>
<b><a href="show.html">hide</a>; <a href="cartoon.html">cartoon</a> suppress f
<br>hb (/a & protein) restrict (/b & protein) reveal true</b>
</blockquote>
&ndash; hide all atoms and show cartoon (enabling coincident backbone-atom display),
then identify H-bonds between
chain A protein and chain B protein, displaying the residues involved;
the parentheses are not required, but may be included for clarity
<blockquote>
<b><a href="delete.html">del</a> solvent; <a href="show.html">hide</a> protein
<br>hb sidechain restrict both reveal t color yellow radius .08
<br>hb sidechain restrict both salt t name "salt bridges" col magenta radius .1</b>
</blockquote>
&ndash; 
delete <a href="atomspec.html#builtin"><b>solvent</b></a>,
hide <a href="atomspec.html#builtin"><b>protein</b></a> atoms, and
calculate all sidechain-sidechain H-bonds and their salt bridge subset
as two separate <a href="../pseudobonds.html">pseudobond models</a>,
displaying the involved residues and making the salt-bridge pseudobonds fatter
so that they are clearly visible over the others

<a name="related"></a>
<p class="nav">
[<a href="#top">back to top: hbonds</a>]
</p>
<h3>H-Bond-Related Features</h3>
<p>
Independent of the <a href="#top"><b>hbonds</b></a> command,
reading an mmCIF file with base-pairing H-bond information automatically creates
<b>hydrogen bonds</b> <a href="../pseudobonds.html">pseudobonds</a>.
The command-line specifier <a href="atomspec.html#builtin"><b>hbonds</b></a>
(not to be confused with the command) refers to pseudobonds
in the <b>hydrogen bonds</b> model(s) and their endpoint atoms.
An interactive histogram of pseudobond lengths can be plotted with 
<a href="crosslinks.html#histogram"><b>crosslinks histogram</b></a>, and a chain 
network diagram summarizing intra- and interchain pseudobonds can be shown with
<a href="crosslinks.html#network"><b>crosslinks network</b></a>.
See also: <a href="style.html"><b>style</b></a>,
<a href="color.html"><b>color</b></a>
</p>

<a name="options"></a>
<p class="nav">
[<a href="#top">back to top: hbonds</a>]
</p>
<h3>Command Options</h3>
<p>
Option keywords and Boolean (truth) values can be truncated, with
synonyms for true: True, 1, and synonyms for false: False, 0.
A vertical bar &ldquo;|&rdquo; designates mutually exclusive values, and
default settings are indicated with <b>bold</b>.
</p>
<blockquote>
<a name="saltOnly"></a>
<b>saltOnly</b> &nbsp;true&nbsp;|&nbsp;<b>false</b>
<br>Whether to limit the results to salt bridges, that is, H-bonds between
formally charged functional groups. 
Such groups are identified by their <a href="../atomtypes.html">atom types</a>,
where possible. In the absence of explicit hydrogens, a histidine sidechain
is assumed to be formally charged unless one of its nitrogens is 
coordinating a metal ion or identified unambiguously as an H-bond acceptor.
</blockquote>
<blockquote>
<a name="restrict"></a>
<b>restrict</b>
&nbsp;cross&nbsp;|&nbsp;both&nbsp;|&nbsp;<b>any</b>&nbsp;|&nbsp;<a href="atomspec.html"><i>atom-spec2</i></a>
<br>Whether to limit H-bond detection to one of the following:
<ul>
<li><b>cross</b> - H-bonds with exactly one atom
in <a href="atomspec.html"><i>atom-spec1</i></a>
<li><b>both</b> - H-bonds with both atoms
in <a href="atomspec.html"><i>atom-spec1</i></a>
<li><b>any</b> (default) - H-bonds with at least one atom
in <a href="atomspec.html"><i>atom-spec1</i></a>
<li>H-bonds between <a href="atomspec.html"><i>atom-spec1</i></a>
and a second set of atoms, <a href="atomspec.html"><i>atom-spec2</i></a>;
the two sets may overlap, but will not overrule other restrictions
(for example, if the two sets are in different models
but <a href="#intermodel"><b>intermodel</b></a> is <b>false</b>,
no H-bonds will be found)
</ul>
</blockquote>
<blockquote>
<a name="makePseudobonds"></a>
<b>makePseudobonds</b> &nbsp;<b>true</b>&nbsp;|&nbsp;false
<br>Whether to show the H-bonds in 3D by creating a
<a href="../pseudobonds.html">pseudobond model</a>.
The pseudobonds will be drawn between the donor and acceptor atoms,
or if hydrogens are present, between the hydrogens and acceptor atoms. 
H-bond pseudobonds are only displayed when both endpoint atoms are displayed,
but the <a href="#reveal"><b>reveal</b></a> option can be used to ensure 
all H-bonds are displayed by displaying the associated residues.
For purposes of pseudobond display, backbone atoms are considered as displayed 
when their display is being
<a href="cartoon.html#suppress">suppressed</a> by cartoon (ribbon).
<p>
The number of H-bonds found may exceed the apparent number of pseudobonds 
because the same pair of atoms could be identified as both
donor-acceptor and acceptor-donor, even if only one of those 
interactions could form at a time.
<!-- example: 1zik HOH residues 50,53 which could be both at same time -->
</p>
</blockquote>
<blockquote>
<a name="name"></a>
<b>name</b> &nbsp;<i>name</i>
<br>Name for the <a href="../pseudobonds.html">pseudobond model</a>
(default <b>hydrogen bonds</b>, also the default name for deletion
with <b>~hbonds</b>). Using a new name creates a separate
model that can be hidden/shown/closed independently.
Names containing spaces must be enclosed in quotation marks.
</blockquote>
<blockquote>
  <b>color</b> &nbsp;<i>colorname</i>
<br>Color to use for <a href="../pseudobonds.html">pseudobonds</a>
depicting H-bonds (but see also <a href="#twoColors"><b>twoColors</b></a>
and <a href="#slopColor"><b>slopColor</b></a>).
The <i>colorname</i> can be any <a href="colornames.html">color name</a>
that specifies a single color (default <b>dark cyan</b>).
Subsequent recoloring without recalculating the H-bonds can be done with 
the <a href="color.html"><b>color</b></a> command, for example:
<b>color&nbsp;<a href="atomspec.html#builtin">hbonds</a>&nbsp;goldenrod&nbsp;target&nbsp;p</b>
</blockquote>
<blockquote>
  <b>radius</b> &nbsp;<i>r</i>
<br>Radius in &Aring; to use for <a href="../pseudobonds.html">pseudobonds</a>
depicting H-bonds (default <b>0.075</b>);
can be changed later with <a href="style.html"><b>style</b></a>.
</blockquote>
<blockquote>
  <b>dashes</b> &nbsp;<i>N</i>
<br>Number of dashes to use for <a href="../pseudobonds.html">pseudobonds</a>
depicting H-bonds (default <b>6</b>).
Only whole numbers are accepted, with 0
indicating solid sticks. Currently, odd numbers are rounded down
to give an even number of dashes. The number of dashes
can be changed later with <a href="style.html"><b>style</b></a>.
</blockquote>
<blockquote>
<font color="brown">
<a name="showDist"></a>
<b>showDist</b> &nbsp;true&nbsp;|&nbsp;<b>false</b>
<br>Whether to label the <a href="../pseudobonds.html">pseudobonds</a>
with the corresponding distances (not yet implemented).
</font>
However, any <a href="../pseudobonds.html">pseudobonds</a>
can be labeled by length with <a href="label.html"><b>label</b></a>
and plotted as a histogram by length with
<a href="crosslinks.html#histogram"><b>crosslinks histogram</b></a>.
</blockquote>
<blockquote>
<a name="reveal"></a>
<b>reveal</b> &nbsp;true&nbsp;|&nbsp;<b>false</b>
<br>Whether to display all atoms of a residue containing an
H-bonding atom if that atom is not displayed initially,
to ensure displaying all H-bond <a href="../pseudobonds.html">pseudobonds</a>.
(By default, if the atom on either end of a
<a href="../pseudobonds.html">pseudobond</a> representing
an H-bond is not shown, the pseudobond itself is not shown, although
it still exists; displaying the atom allows the H-bond to be shown.)
</blockquote>
<blockquote>
  <b>interSubmodel</b> &nbsp;true&nbsp;|&nbsp;<b>false</b>
<br>Whether to look for H-bonds between
<a href="atomspec.html#hierarchy">submodels</a> of the same model.
</blockquote>
<blockquote>
<a name="intermodel"></a>
<b>interModel</b></a> &nbsp;<b>true</b>&nbsp;|&nbsp;false
<br>Whether to look for H-bonds between models.
</blockquote>
<blockquote>
<b>intraModel</b> &nbsp;<b>true</b>&nbsp;|&nbsp;false
<br>Whether to look for H-bonds within models.
</blockquote>
<blockquote>
<b>intraMol</b> &nbsp;<b>true</b>&nbsp;|&nbsp;false
<br>Whether to include intramolecular H-bonds,
where a molecule is defined as a covalently bonded set of atoms.
</blockquote>
<blockquote>
<b>intraRes</b> &nbsp;<b>true</b>&nbsp;|&nbsp;false
<br>Whether to include intraresidue H-bonds.
</blockquote>
<blockquote>
<a name="cacheDA"></a>
<b>cacheDA</b> &nbsp;true&nbsp;|&nbsp;false
<br>Whether to cache and reuse donor and acceptor information
rather than regenerating it each time the command is used;
useful for calculations on different conformations of the same structure.
The default is <b>true</b> for a <a href="../trajectories.html">trajectory</a>, 
otherwise <b>false</b>.
</blockquote>
<blockquote>
<a name="relax"></a>
<b>relax</b> &nbsp;<b>true</b>&nbsp;|&nbsp;false
<br>Whether to relax the
<a href="#criteria">precise criteria</a> for hydrogen bonding.
</blockquote>
<a name="tolerances"></a>
<blockquote>
  <b>distSlop</b> &nbsp;<i>tolerance</i>
<br>How much to relax the distance criteria if
<a href="#relax"><b>relax</b></a> is <b>true</b>;
<i>tolerance</i> is <b>0.4</b> &Aring; by default.
</blockquote>
<blockquote>
  <b>angleSlop</b> &nbsp;<i>tolerance</i>
<br>How much to relax the angle criteria if
<a href="#relax"><b>relax</b></a> is <b>true</b>;
<i>tolerance</i> is <b>20.0</b> degrees by default.
</blockquote>
<blockquote>
<a name="twoColors"></a>
<b>twoColors</b> &nbsp;true&nbsp;|&nbsp;<b>false</b>
<br>Whether to use different colors for H-bonds meeting and not
meeting the precise criteria (<i>i.e.</i>, whether a different color
should be used for H-bonds outside the precise criteria but within
the tolerance values).
</blockquote>
<blockquote>
<a name="slopColor"></a>
<b>slopColor</b> &nbsp;<i>colorname</i>
<br>If <a href="#twoColors"><b>twoColors</b></a>
is <b>true</b>, the color to use for H-bonds not meeting the 
precise criteria but within the tolerance values. 
The <i>colorname</i> can be any <a href="colornames.html">color name</a> 
that specifies a single color (default <b>dark orange</b>).
</blockquote>
<blockquote>
<b>retainCurrent</b> &nbsp;true&nbsp;|&nbsp;<b>false</b>
<br>Whether to keep the <a href="../pseudobonds.html">pseudobonds</a>
depicting a previously determined set of H-bonds through a subsequent
round of detection (as opposed to replacing the old with the new).
Regardless of this setting, however, pre-existing H-bond pseudobonds
will not be replaced if the new pseudobond model is given a different
<a href="#name">name</a>.
</blockquote>
<blockquote>
  <a name="saveFile"><b>saveFile</b> &nbsp;<i>file</i></a>
<br>Save H-bond information to a file.
The information includes donor and acceptor atom specifications
(see <a href="#namingStyle"><b>namingStyle</b></a>),
donor-acceptor distances, and when hydrogens are present,
hydrogen atom specifications and hydrogen-acceptor distances.
<i>File</i> is the output file pathname,
enclosed in quotation marks if it includes spaces,
or the word <a href="usageconventions.html#browse"><b>browse</b></a>
to specify it interactively in a file browser window.
</blockquote>
<blockquote>
  <a name="log"><b>log</b> &nbsp;true&nbsp;|&nbsp;<b>false</b></a>
<br>Whether to write H-bond information (as described above for
<a href="#saveFile"><b>saveFile</b></a>) to the
<a href="../tools/log.html"><b>Log</b></a>.
</blockquote>
<blockquote>
  <a name="namingStyle"><b>namingStyle</b> &nbsp;simple&nbsp;|&nbsp;command&nbsp;|&nbsp;serial</a>
<br>How to describe atoms in H-bond information
written to a <a href="#saveFile">file</a> or the <a href="#log">log</a>:
<ul>
<li><b>simple</b> - chain ID (preceded by slash), 
residue name, residue number, atom name (for example, /B ASN 21 OD1)
<li><b>command</b>
- <a href="atomspec.html#hierarchy">command-line specifier</a>
(for example, /B:21@OD1)
<li><b>serial</b> - atom serial number
(for example, 126)
</ul>
Model number will be included when multiple models are present.
</blockquote>
<blockquote>
  <b>batch</b> &nbsp;true&nbsp;|&nbsp;<b>false</b>
<br>Whether to suppress certain errors; useful for no-GUI
batch processing.  Currently, the only error suppressed when
<b>batch</b> is <b>true</b> is that which arises if no atoms are
<a href="../selection.html">selected</a>
when <a href="#selRestrict"><b>selRestrict</b></a> is specified.
</blockquote>

<a name="criteria"></a>
<p class="nav">
[<a href="#top">back to top: hbonds</a>]
</p>
<h3>Method and Geometric Criteria</h3>
<p>
Distance and angle cutoffs for H-bonding
are based on a survey of small-molecule crystal structures, as described in
<blockquote>
<a href="http://www.ncbi.nlm.nih.gov/pubmed/9007693" target="_blank">
Three-dimensional hydrogen-bond geometry and probability information
from a crystal survey.</a>
Mills JE, Dean PM.
<i>J Comput Aided Mol Des.</i> 1996 Dec;10(6):607-22.
</blockquote>
There are many different sets of geometric
criteria, corresponding to the many different donor-acceptor combinations
(see Tables 5-8 in the reference).
There is an upper bound on distance and one or more
angular range criteria for each category of H-bond.
It is generally useful to relax the criteria since most structures
are not as high-resolution as those used in the survey.
User-specified <a href="#tolerances">tolerances</a>
are added to each criterion's upper bound and/or subtracted from
its lower bound (depending on the particular criterion).
</p><p>
Chimera uses atom and residue names, or if these are not &ldquo;standard,&rdquo;
the coordinates of atoms, to determine connectivity and
<a href="../atomtypes.html">atom types</a>,
which in turn determine which geometric criteria are appropriate for
detecting a hydrogen bond between specific atoms.
Possible donor groups are hydrogen-bearing nitrogen, oxygen, and sulfur atoms,
and possible acceptor groups are nitrogen, oxygen, and sulfur atoms
with a lone pair.  H-bonds involving other types of atoms are not considered.
Not all of the possible donor-acceptor combinations were listed
in the Mills and Dean parameter tables; some categories of sulfur
were not surveyed, and several combinations of the surveyed types
were not observed frequently enough to collect good statistics on their
geometries.  In such cases, <b>FindHbond</b>
applies estimated H-bond criteria.
</p><p>
When there are no explicit hydrogens on a potential donor atom,
<b>FindHBond</b> will use the donor
<a href="../atomtypes.html">atom type</a> to infer their presence.
For functional groups where the hydrogen
positions are well-determined by the positions of the nonhydrogen atoms,
the H-bonds detected in the presence and absence of explicit hydrogen
atoms should be virtually identical.  For functional groups where the
hydrogen position is not well-determined (such as rotatable hydroxyls),
the presence of an explicit hydrogen atom will limit the detected
H-bonds to those appropriate for the observed position, instead of
all of its possible positions.
</p>

<hr>
<address>UCSF Resource for Biocomputing, Visualization, and Informatics /
September 2017</address>
</body></html>
