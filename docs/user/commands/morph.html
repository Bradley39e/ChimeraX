<html>

<!--
=== UCSF ChimeraX Copyright ===
Copyright 2016 Regents of the University of California.
All rights reserved.  This software provided pursuant to a
license agreement containing restrictions on its disclosure,
duplication and use.  For details see:
http://www.rbvi.ucsf.edu/chimerax/docs/licensing.html
This notice must be embedded in or attached to all copies,
including partial copies, of the software or any revisions
or derivations thereof.
=== UCSF ChimeraX Copyright ===
-->

<head>
<link rel="stylesheet" type="text/css" href="../userdocs.css" />
<title>Command: morph</title>
</head><body>

<a name="top"></a>
<a href="../index.html">
<img width="60px" src="../ChimeraX-docs-icon.svg" alt="ChimeraX docs icon"
class="clRight" title="User Guide Index"/></a>

<h3><a href="../index.html#commands">Command</a>: morph</h3>

<h3 class="usage"><a href="usageconventions.html">Usage</a>:
<br><b>morph</b>
&nbsp;<a href="atomspec.html#hierarchy"><i>model-spec</i></a>&nbsp;
[&nbsp;<b>frames</b>&nbsp;&nbsp;<i>N</i>&nbsp;]
[&nbsp;<b>same</b>&nbsp;&nbsp;true&nbsp;|&nbsp;<b>false</b>&nbsp;]
[&nbsp;<b>hideModels</b>&nbsp;&nbsp;<b>true</b>&nbsp;|&nbsp;false&nbsp;]
[&nbsp;<b>play</b>&nbsp;&nbsp;<b>true</b>&nbsp;|&nbsp;false&nbsp;]
[&nbsp;<b>slider</b>&nbsp;&nbsp;<b>true</b>&nbsp;|&nbsp;false&nbsp;]
&nbsp;<a href="#morph-parameters"><i>morph-parameters</i></a></h3>
<p>
The <b>morph</b> command creates a 
<a href="../trajectories.html">trajectory</a> that morphs between two or
more atomic models. The trajectory can be played back
with the <a href="coordset.html"><b>coordset</b></a> command
or the <a href="#slider">slider</a> graphical interface.
See also: 
<a href="../movies.html">making movies</a>
</p><p>
Before morphing, the atomic models should be superimposed
(such as with <a href="matchmaker.html"><b>matchmaker</b></a>).
In the <b>morph</b> command, the models should be specified in the order
desired for morphing.
Although the same model number cannot be given more than once, a given structure 
can be opened multiple times to give copies with different model numbers.
Examples:
</p>
<blockquote><b>
morph #3,1,2 frames 40
<br>
morph #1.1-20 same t
<br>
morph #2,5 core 0.1 frames 30
</b></blockquote>
<p>
Only the <a href="#pairing"><b><i>atoms in common</i></b></a>
among the input structures will be included in the resulting trajectory.
The models can have different numbers of residues or different
sequences (homologs or mutants can be compared), but currently
they must contain equal numbers of chains
(see <a href="#limitations">limitations</a>).
</p><p>
<a name="stage"></a>
Each sequential pair of input structures serves as the
starting and ending points of one <b><i>stage</i></b> of the
trajectory, and a morph trajectory can have multiple stages.
Within each stage, intermediate coordinate sets 
are generated by interpolating the positions of the
<a href="#pairing">atoms in common</a>. Interpolation includes:
</p>
<ol>
<li>rigid-body transformations of atom groups
partitioned by hinge regions.  Hinges are identified as described in
<a href="http://www.ncbi.nlm.nih.gov/pubmed/10734184" target="_blank">Krebs
and Gerstein</a>, <i>Nucleic Acids Res</i> <b>28</b>:1665 (2000).
<li><a name="flexible">coordinate changes within the atom groups</a>
</ol>
<p>
Coordinates for the <a href="#pairing">atoms in common</a> 
from the input structures and the intermediate coordinate sets 
comprise the frames of the <a href="../trajectories.html">trajectory</a>,
which is opened as a separate model. 
</p><p>
The <b>frames</b> option (default <i>N</i> = <b>20</b>) indicates generating 
<i>N</i>&ndash;1 intermediate coordinate sets per <a href="#stage">stage</a>,
giving a total number of frames in the trajectory
= 1 + <i>N</i>(number of stages).
</p><p>
<a name="same"></a>
The <b>same</b> option indicates that the input structures 
have the same sequences, atom names, residue numbering, and chain IDs, 
as is typically the case for members of an NMR ensemble 
(default <b>false</b>, atoms paired as described 
<a href="#pairing">below</a>). Setting this option to <b>true</b> may 
make the calculation slightly faster, but otherwise there is little harm
in staying with the default if there is any doubt as to 
whether numbering/naming are the same.
</p><p>
The <b>hideModels</b> option (default <b>true</b>) hides the input models,
and the <b>play</b> option 
(default <b>true</b>) plays through the resulting trajectory a single time. 
Regardless of the <b>play</b> option, the
<a href="coordset.html"><b>coordset</b></a> command 
and/or the <a href="#slider">slider</a> can be used to replay the trajectory.
</p><p>
<a name="slider"></a>
The <b>slider</b> option (default <b>true</b>) shows a graphical interface
for trajectory playback.
The slider can be dragged or a frame number entered directly.
The interface also includes a play/pause button and another
(marked with a red dot) for recording a movie. See also:
<a href="coordset.html#slider"><b>coordset slider</b></a>
</p>

<a name="morph-parameters"></a>
<p class="nav">
[<a href="#top">back to top: morph</a>]
</p>
<h3>Morphing Parameters</h3>
<blockquote>
<b>method</b>&nbsp;(&nbsp;<b>corkscrew</b>&nbsp;|&nbsp;independent&nbsp;|&nbsp;linear&nbsp;)
<br>
How to calculate the rigid-body transformations
within a <a href="#stage">stage</a>:
  <ul>
  <li><b>corkscrew</b> (default)
  - each group's starting and ending positions are related
  by a rotation about a center chosen to describe as much of the movement
  as possible, and a translation along the axis of rotation;
  these two components are interpolated
  <li><b>independent</b>
  - each group's starting and ending positions are related
  by a rotation about the group's center of mass, and a translation;
  these two components are interpolated
  <li><b>linear</b>
  - each group's starting and ending positions are related by a translation,
  which is interpolated
  </ul>
</blockquote>
<blockquote>
<b>rate</b>&nbsp;&nbsp;<i>function</i>
<br>
How conformational changes within a <a href="#stage">stage</a>
are distributed across the trajectory, where the <i>function</i> can be:
  <ul>
  <li><b>linear</b> (default)
  - coordinate changes will be distributed approximately evenly
  <li><b>ramp down</b>
  - coordinates will change most rapidly near the starting conformation
  <li><b>ramp up</b>
  - coordinates will change most rapidly near the ending conformation
  <li><b>sinusoidal</b> - coordinates will change most rapidly halfway
  between the starting and ending conformations
  </ul>
</blockquote>
<blockquote>
<b>coreFraction</b>&nbsp;&nbsp;<i>f</i>
<br>
<b>minHingeSpacing</b>&nbsp;&nbsp;<i>M</i>
<br>
<b>colorSegments</b>&nbsp;&nbsp;true&nbsp;|&nbsp;<b>false</b>
<br>
<b>colorCore</b>&nbsp;&nbsp;<a href="colornames.html"><i>color</i></a>
<br><br style="line-height:5px">
The <b>coreFraction</b> <i>f</i> (default <b>0.5</b>) is the
fraction of the residues in a chain
to group in the first step of hinge detection.
The best-matching fraction <i>f</i> of residues (best-fitting between
the starting and ending structures) comprises one group
and the remaining (1&ndash;<i>f</i>) a second group. Going through the
residues in order, hinges are added between consecutive residues where
there is a change from one group to the other, as long as a hinge is
at least <b>minHingeSpacing</b> <i>M</i> residues 
away from the previous hinge (does not create a
segment shorter than <i>M</i> residues, default <b>6</b>).
The <b>colorSegments</b> option
shows the resulting segments in different colors (chosen automatically),
whereas <b>colorCore</b> uses the specified
<a href="colornames.html"><i>color</i></a> for residues in the initial core.
Although segments are recomputed for each <a href="#stage">stage</a> 
of a multistage morph, segment coloring only shows the first set.
</blockquote>
<blockquote>
<b>cartesian</b>&nbsp;&nbsp;true&nbsp;|&nbsp;<b>false</b>
<br>
Whether <a href="#flexible">within-group coordinate changes</a>
should be interpolated strictly in Cartesian space.
Otherwise, internal coordinates will be used for the
interpolation where possible. Using internal coordinates is slower
but produces less distortion. A trajectory made with Cartesian forcing
may be acceptable if few atomic details will be shown (for example,
if only ribbons will be displayed).
</blockquote>

<a name="pairing"></a>
<p class="nav">
[<a href="#top">back to top: morph</a>]
</p>
<h3>Atoms in Common</h3>
<p>
Coordinate sets are generated by
interpolating between starting and ending structures.
Interpolation requires a pairing of atoms in the starting structure
with atoms in the ending structure.
Only atoms common to both <a href="#stage">stage</a> endpoints
are included in the morph trajectory.
</p><p>
The structures must contain equal numbers of biopolymer chains
(see <a href="#limitations">limitations</a>).
Unless <a href="#same"><b>same</b></a> is <b>true</b>, atoms are paired
as follows:
</p>
<blockquote>
<p>
If the sets of chain IDs are identical (for example, each structure contains
chains A and B), the IDs will be used to indicate pairing; if they differ
(for example, one structure contains chains A and B, whereas another contains
chains A and D), the chains will be paired by their order of occurrence
in the input files.
Residues are paired by aligning the chain sequences.
The sequence alignment is performed using the
<a href="matchmaker.html"><b>matchmaker</b></a> defaults
(Needleman-Wunsch algorithm, BLOSUM-62 matrix, secondary structure reassignment
with <a href="dssp.html"><b>dssp</b></a>,
30% secondary structure scoring, <i>etc.</i>),
except that the Nucleic matrix is used for nucleic acids.
Only the sequence alignment stage of
<a href="matchmaker.html"><b>matchmaker</b></a> is
performed, not the superposition of structures.
</p><p>
HET residues such as ligands and ions are only included
if they are present in both structures and
attached to the same atom(s) in the paired chains
by at least one &ldquo;covalent&rdquo; bond
<!--
(which can be an unrealistic bond added manually and subsequently undisplayed)
-->
or <a href="../pseudobonds.html">pseudobond</a>.
</p><p>
Once residues are paired, atoms in common within those residues are paired.
In paired residues of the same type, atom pairing is straightforward.
In paired residues of different types, only atoms with the same names
are paired, and only a single connected fragment is kept per residue.
For example (disregarding hydrogens),
phenylalanine and tyrosine have in common all atoms of phenylalanine.
</p>
</blockquote>

<a name="limitations"></a>
<p class="nav">
[<a href="#top">back to top: morph</a>]
</p>
<h3>Limitations</h3>
<p>
<b>Secondary structure is not automatically re-evaluated during playback</b>.
Protein <a href="cartoon.html">cartoon</a> (ribbon) display
depends on which residues are in helices and strands,
but these secondary structure assignments are not recomputed automatically
as the coordinates change.  The <b>computeSS</b> option of
<a href="coordset.html"><b>coordset</b></a> or an
<a href="coordset.html#ssnote">alternative approach</a> should be used to
update the assignments.
</p>
<p>
<b>Structures with different numbers of chains are not handled</b>.
Currently, a morph trajectory can only be generated from input structures
with equal numbers of biopolymer chains.
Extra chains in the input models should be
<a href="delete.html">deleted</a> beforehand
or <a href="split.html">split</a> into separate models not used in morphing.
</p>
<p>
<b>Sequences should be easy to align</b>.
The sequences of the structures must be
aligned to determine the <a href="#pairing">atoms in common</a>
for interpolation.  When the sequences are dissimilar,
parts of the sequence alignment may be wrong, leading to a jumbled
and unattractive morph trajectory.
</p>

<hr>
<address>UCSF Resource for Biocomputing, Visualization, and Informatics /
October 2017</address>
</body></html>
