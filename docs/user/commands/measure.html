<html>

<!--
=== UCSF ChimeraX Copyright ===
Copyright 2016 Regents of the University of California.
All rights reserved.  This software provided pursuant to a
license agreement containing restrictions on its disclosure,
duplication and use.  For details see:
http://www.rbvi.ucsf.edu/chimerax/docs/licensing.html
This notice must be embedded in or attached to all copies,
including partial copies, of the software or any revisions
or derivations thereof.
=== UCSF ChimeraX Copyright ===
-->

<head>
<link rel="stylesheet" type="text/css" href="../userdocs.css" />
<title>Command: measure</title>
</head><body>

<a name="top"></a>
<a href="../index.html">
<img width="60px" src="../ChimeraX-docs-icon.svg" alt="ChimeraX docs icon"
class="clRight" title="User Guide Index"/></a>

<h3><a href="../index.html#commands">Command</a>: measure</h3>

<h3 class="usage"><a href="usageconventions.html">Usage</a>:
<br><b>measure</b> &nbsp;<i>property</i> &nbsp;<i>arguments</i></h3>
<p>
The <b>measure</b> command performs various calculations
and sends results to the <a href="../tools/log.html"><b>Log</b></a>.
Possible values of <i>property</i>:
</p>
<ul>
<li><a href="#area"><b>area</b></a> 
- report the area of an existing surface (sum of surface triangles)
<li><a href="#buriedarea"><b>buriedarea</b></a> 
- calculate <a href="surface.html#surfdefs">solvent-accessible surface</a>
area buried between two sets of atoms
<li><a href="#center"><b>center</b></a>
- calculate center of mass of map and/or atoms
<li><a href="#convexity"><b>convexity</b></a>
- calculate convexity at each surface vertex, color the surface accordingly
<li><a href="#inertia"><b>inertia</b></a>
- calculate inertia ellipsoid
<li><a href="#length"><b>length</b></a>
- sum bond lengths
<li><a href="#mapstats"><b>mapstats</b></a>
- report <a href="../tools/volumeviewer.html">volume data</a> 
min, max, mean, SD, and RMSD values
<li><a href="#motion"><b>motion</b></a>
- show changes in surface position by drawing lines
<li><a href="#sasa"><b>sasa</b></a>
- calculate <a href="surface.html#surfdefs">solvent-accessible surface</a> area
<li><a href="#volume"><b>volume</b></a> 
- report the volume enclosed by an existing surface
</ul>
<p>
See also: <a href="interfaces.html"><b>interfaces</b></a>,
<a href="surface.html"><b>surface</b></a>,
<a href="surface.html#zone"><b>surface zone</b></a>,
<a href="../radii.html">VDW radii</a>,
<a href="../measurements.html">measurements</a>
</p>

<a href="#top" class="nounder">&bull;</a>
<a name="area"><b>measure area</b></a>
&nbsp;<a href="atomspec.html#othermodels"><i>surf-model</i></a>&nbsp;
[&nbsp;<b>includeMasked</b> &nbsp;<b>true</b>&nbsp;|&nbsp;false&nbsp;]
<blockquote>
Report the total surface area of an existing surface model, computed as the
sum of the areas of its triangles.
The <b>includeMasked</b> option controls
whether to include parts of the surface that have been hidden,
such as with <a href="surface.html#dust"><b>surface dust</b></a>
or <a href="surface.html#zone"><b>surface zone</b></a>
(<a href="clip.html">clipping</a> does not affect the measurement, however).
See also: <a href="#sasa"><b>measure sasa</b></a>
</blockquote>

<a href="#top" class="nounder">&bull;</a>
<a name="buriedarea"><b>measure buriedarea</b></a>
&nbsp;<a href="atomspec.html"><i>atom-spec1</i></a>&nbsp; <b>withAtoms2</b>
&nbsp;<a href="atomspec.html"><i>atom-spec2</i></a>&nbsp;
[&nbsp;<b>probeRadius</b>&nbsp;&nbsp;<i>rad</i>&nbsp;]
[&nbsp;<b>listResidues</b>&nbsp;&nbsp;true&nbsp;|&nbsp;<b>false</b>&nbsp;]
[&nbsp;<b>cutoffArea</b>&nbsp;&nbsp;<i>area</i>&nbsp;] 
[&nbsp;<b>select</b>&nbsp;&nbsp;true&nbsp;|&nbsp;<b>false</b>&nbsp;]
[&nbsp;<b>color</b>&nbsp;&nbsp;<a href="colornames.html"><i>color-spec</i></a>&nbsp;]
<blockquote>
Calculate the <a href="surface.html#surfdefs">solvent-accessible surface</a>
(SAS) area buried between two sets of atoms, defined as:
<blockquote>
&frac12;
(<i>sasa1</i>&nbsp;+&nbsp;<i>sasa2</i>&nbsp;&ndash;&nbsp;<i>sasa12</i>)
</blockquote>
where &nbsp;<i>sasa1</i> is the area of the SAS
enclosing the atoms in &nbsp;<a href="atomspec.html"><i>atom-spec1</i></a>,
&nbsp;<i>sasa2</i> is the area of the SAS 
enclosing the atoms in &nbsp;<a href="atomspec.html"><i>atom-spec2</i></a>,
and &nbsp;<i>sasa12</i> is the area of the SAS enclosing both sets of atoms
together. 
The sets of atoms should be specified with care; they should not overlap,
and solvent, ions, and ligand residues are not excluded automatically.
Unspecified atoms are ignored.
The default <b>probeRadius</b> <i>rad</i> for calculating each SAS
is <b>1.4</b> &Aring;, often used to approximate a water molecule.
Residues with at least <b>cutoffArea</b> <i>area</i> buried
(default <b>1.0</b> &Aring;<sup>2</sup>) can be:
<ul>
<li>listed along with their buried areas
in the <a href="../tools/log.html"><b>Log</b></a> 
using the <b>listResidues</b> option
<li><a href="../selection.html">selected</a> with the <b>select</b> option
<li>colored using <b>color</b> <a href="colornames.html"><i>color-spec</i></a>
</ul>
<p>
The buried area of a residue is its SAS area in the individual set minus
that in the combined set.
Examples:
</p>
<blockquote>
<b>measure buriedarea (/c & protein) with (/d & protein)</b>
<br>
&ndash; calculate buried surface area between the
<a href="atomspec.html#builtin"><b>protein</b></a> parts only of chains C and D
<br><br>
<b>measure buried ligand with protein list T sel T</b>
<br>
&ndash; select and list residues with &ge; 1.0 &Aring;<sup>2</sup> area
buried between <a href="atomspec.html#builtin"><b>ligand</b></a> and
<a href="atomspec.html#builtin"><b>protein</b></a>
</blockquote>
</blockquote>

<a href="#top" class="nounder">&bull;</a>
<a name="center"></a>
<b>measure center</b> 
&nbsp;<a href="atomspec.html"><i>spec</i></a>&nbsp;
[&nbsp;<b>level</b>&nbsp;&nbsp;<i>contour-level</i>&nbsp;]
[&nbsp;<b>mark</b>&nbsp;&nbsp;true&nbsp;|&nbsp;<b>false</b>&nbsp;]
[&nbsp;<b>radius</b>&nbsp;&nbsp;<i>marker-radius</i>&nbsp;]
[&nbsp;<b>color</b>&nbsp;&nbsp;<a href="colornames.html"><i>color-spec</i></a>&nbsp;]
[&nbsp;<b>modelId</b>&nbsp;&nbsp;<i>model-number</i>&nbsp;]
[&nbsp;<b>name</b>&nbsp;&nbsp;<i>model-name</i>&nbsp;]
<blockquote>
Calculate the center of mass of each density map and/or set of atoms in 
<a href="atomspec.html"><i>spec</i></a>.
Map centers are reported in grid indices,
atomic centers of mass in the atomic coordinate system.
The <b>level</b> option indicates using only map regions
above <i>contour-level</i>.
If <b>mark</b> is <b>true</b>, a <a href="../markers.html">marker</a> 
will be placed at at each computed center, with radius <i>marker-radius</i> 
(default based on the contents of <a href="atomspec.html"><i>spec</i></a>)
and color (default <b>#b4b4b4</b>
<table border cellpadding="4" cellspacing="0"
style="display:inline-block; vertical-align:middle"><tr>
<td bgcolor=#b4b4b4 width="10px" title="#b4b4b4"></td></tr></table>).
The marker model is opened as number <i>model-number</i>
(default next unused number) with name <i>model-name</i>
(default based on the contents of <a href="atomspec.html"><i>spec</i></a>).
See also: <a href="cofr"><b>cofr</b></a>
</blockquote>

<a href="#top" class="nounder">&bull;</a>
<a name="convexity"></a>
<b>measure convexity</b>
&nbsp;<a href="atomspec.html#othermodels"><i>surf-model</i></a>&nbsp;
[&nbsp;<b>smoothingIterations</b>&nbsp;&nbsp;<i>N</i>&nbsp;]
[&nbsp;<b>writeSurfaceData</b>&nbsp;&nbsp;<i>filename</i>&nbsp;]
[&nbsp;<b>patches</b>&nbsp;&nbsp;<i>convexity-threshold</i>&nbsp;]
&nbsp;<a href="color.html#palette-options"><i>palette-options</i></a>&nbsp;
<blockquote>
Color a surface based on the convexity at each vertex, 
calculated as 2&pi; minus the cone-angle spanned by the triangles incident 
at the vertex. Convexity values are smoothed by averaging with 
neighboring (edge-connected) vertices for a specified number of iterations
(default <b>5</b>). Smoothing is generally recommended, given that this
definition of convexity is nonstandard and the unsmoothed values 
depend strongly on the triangulation:
vertices surrounded by large triangles on a smooth surface 
will have sharper cone angles than vertices surrounded by small triangles.
(Normalizing by triangle areas does not help because the patch around
a vertex is often irregular in shape.) 
The surface vertex positions, normals, convexity values, and triangles 
can be saved to a text file with <b>writeSurfaceData</b>,
where <i>filename</i> can be a pathname including the directory location.
<p>
The remaining options specify coloring.
The <b>patches</b> option randomly assigns colors to contiguous patches
of vertices with convexity values above the <i>convexity-threshold</i>. 
Otherwise (<b>patches</b> not used),
the surface will be colored by the convexity value per vertex,
with <i>palette-options</i> as
<a href="color.html#palette-options">described for <b>color</b></a>,
except with defaults 
<table border cellpadding="4" cellspacing="0"
style="display:inline-block; vertical-align:middle"><tr>
<td bgcolor=#0f1bc7adcf5b width="10px"></td>
<td bgcolor=#b333b333b333 width="10px"></td>
<td bgcolor=#9eb820005eb8 width="10px"></td>
</tr></table>:
<blockquote>
<b>palette&nbsp;cyan-gray-maroon&nbsp;&nbsp;range&nbsp;-1,1</b>
</blockquote>
Unsmoothed values typically give mottled coloring.
See also: <a href="mlp.html"><b>mlp</b></a>, 
<a href="color.html"><b>color</b></a>,
<a href="bumps.html"><b>bumps</b><?a>
</blockquote>

<a href="#top" class="nounder">&bull;</a>
<a name="inertia"><b>measure inertia</b></a>
&nbsp;<a href="atomspec.html"><i>atom-spec</i></a>&nbsp;
[&nbsp;<b>perChain</b>&nbsp;&nbsp;true&nbsp;|&nbsp;<b>false</b>&nbsp;]
[&nbsp;<b>showEllipsoid</b>&nbsp;&nbsp;<b>true</b>&nbsp;|&nbsp;false&nbsp;]
[&nbsp;<b>color</b>&nbsp;&nbsp;<a href="colornames.html"><i>color-spec</i></a>&nbsp;]
[&nbsp;<b>modelId</b>&nbsp;&nbsp;<i>model-number</i>&nbsp;]
[&nbsp;<b>replace</b>&nbsp;&nbsp;true&nbsp;|&nbsp;<b>false</b>&nbsp;]
<blockquote>
Calculate the inertia ellipsoid for
&nbsp;<a href="atomspec.html"><i>atom-spec</i></a>,&nbsp;
which could include atoms and/or surfaces.
Atoms are mass-weighted; surfaces are treated
as thin shells with mass proportional to surface area
(<a href="#notes">details...</a>).
If both atoms and surfaces are specified, separate ellipsoids are
calculated (a combined calculation cannot be performed).
Principal axes, lengths, moments, and center are reported for each ellipsoid,
using the model coordinate system of the first atom or surface
specified to define it.
The vectors v1, v2, and v3 are the principal axes (longest to shortest).
The lengths a, b, c are half-diameters along axes v1, v2, and v3,
respectively. The moments r1, r2, and r3 are calculated as
(inertia/mass)<sup>&frac12;</sup>
about axes v1, v2, and v3, respectively. They can be considered
effective radii; placing all of the mass at that distance from the center
would reproduce the moment of inertia calculated for the structure
around that axis.
<p>
The <b>perChain</b> option indicates whether
to calculate a separate ellipsoid for each chain in
<a href="atomspec.html"><i>atom-spec</i></a>.
If <b>showEllipsoid</b> is <b>true</b> (default),
the ellipsoid(s) will be opened as a surface model with
<b>modelId</b> &nbsp;<i>model-number</i> (default the next unused number),
containing multiple submodels if there are multiple ellipsoids.
The <b>replace true</b> option allows replacing an existing model
when the specified <i>model-number</i> is already in use.
If ellipsoid <b>color</b> is not specified, each ellipsoid will be colored
to match the first atom or surface in its calculation.
</p><p>
Another way to generate a low-resolution
representation of an atomic structure is with
<a href="molmap.html"><b>molmap</b></a>.
<!--
See also:
<a href="define.html#axis"><b>define axis</b></a>,
<a href="aniso.html"><b>aniso</b></a>,
<a href="shape.html#ellipsoid"><b>shape ellipsoid</b></a>,
<a href="../print.html#objects">geometric objects</a>
-->
</p>
</blockquote>

<a href="#top" class="nounder">&bull;</a>
<a name="length"><b>measure length</b></a>
&nbsp;<a href="atomspec.html"><i>atom-spec</i></a>&nbsp;
<blockquote>
Sum the lengths of all bonds between specified atoms 
(<a href="../markers.html">markers</a>);
primarily used to measure the length of traced paths of markers.
</blockquote>

<a href="#top" class="nounder">&bull;</a>
<a name="mapstats"><b>measure mapstats</b></a>
[&nbsp;<a href="atomspec.html#othermodels"><i>volume-spec</i></a>&nbsp;]
[&nbsp;<b>step</b> &nbsp;<i>N</i>&nbsp;|&nbsp;<i>Nx,Ny,Nz</i>&nbsp;]
[&nbsp;<b>subregion</b> &nbsp;<i>name</i>&nbsp;|&nbsp;<i>i1,j1,k1,i2,j2,k2</i>&nbsp;|&nbsp;<b>all</b>&nbsp;]
<blockquote>
Report the minimum value, maximum value, mean, standard deviation (SD) 
from the mean, and the root-mean-square (RMS) deviation from zero for
the specified <a href="../tools/volumeviewer.html">volume data</a> models,
if any, otherwise all such models.
The <b>step</b> and <b>subregion</b> options can be used to limit
the calculation to a subsample or spatial subregion of the data.
The step size must be an integer; 1 indicates all data points (default),
2 indicates every other data point, 3 every third point, <i>etc.</i>
If a single number is supplied, it is used along all three axes; 
if three numbers are supplied (separated by commas but not spaces), they
are used along the X, Y, and Z axes, respectively.
A subregion can be specified by:
  <ul>
  <li><i>name</i> previously assigned
  with the <a href="volume.html#dimensions"><b>nameRegion</b> 
  option of <b>volume</b></a>
  <li>grid indices
  <i>i1&ndash;i2</i> along the X axis,
  <i>j1&ndash;j2</i> along the Y axis, and
  <i>k1&ndash;k2</i> along the Z axis.
  Grid indices must be integers separated by commas but not spaces.
  <li>the word <b>all</b>, indicating the full extent of the data
  (default) rather than a subregion
  </ul>
See also: <a href="../measurements.html">measurements</a>
</blockquote>

<a href="#top" class="nounder">&bull;</a>
<a name="motion"><b>measure motion</b></a>
&nbsp;<a href="atomspec.html#othermodels"><i>surf-model</i></a>&nbsp;
<b>toMap</b>&nbsp;&nbsp;<a href="atomspec.html#othermodels"><i>map-model</i></a>&nbsp;
[&nbsp;<b>color</b>&nbsp;&nbsp;<a href="colornames.html"><i>color-spec</i></a>&nbsp;]
[&nbsp;<b>steps</b>&nbsp;&nbsp;<i>M</i>&nbsp;]
[&nbsp;<b>scale</b>&nbsp;&nbsp;<i>f</i>&nbsp;]
[&nbsp;<b>pricklesModel</b>&nbsp;&nbsp;<i>N</i>&nbsp;]
<blockquote>
Draw &ldquo;prickles&rdquo; to show the change in position
between a surface and a <a href="../tools/volumeviewer.html">volume</a>
(map) isosurface, for example, between time steps of a
<a href="../trajectories.html#vseries">volume series</a>.
Prickles are line segments drawn perpendicular to the surface.
They are extended from the vertices of <i>surf-model</i>
in increments of map grid units 
(using the smallest spacing along the three axes, if they differ)
until they intersect with the map isosurface or reach
<b>steps</b> <i>M</i> grid units in length (default <b>10</b>).
Prickles are shown in the specified <b>color</b> (default <b>lime</b>
<table border cellpadding="4" cellspacing="0"
style="display:inline-block; vertical-align:middle"><tr>
<td bgcolor=lime width="10px" title="lime"></td></tr></table>) and
can be amplified or shrunken in length by a <b>scale</b> factor <i>f</i>.
If a model number is specified with <b>pricklesModel</b> <i>N</i>,
the prickles will be added as a submodel of <i>N</i>.
If a model number is not specified,
the new model will be a submodel of <i>surf-model</i>.
</blockquote>

<a href="#top" class="nounder">&bull;</a>
<a name="sasa"><b>measure sasa</b></a>
&nbsp;<a href="atomspec.html"><i>atom-spec1</i></a>&nbsp;
[&nbsp;<b>probeRadius</b>&nbsp;&nbsp;<i>rad</i>&nbsp;]
[&nbsp;<b>setAttribute</b>&nbsp;&nbsp;<b>true</b>&nbsp;|&nbsp;false&nbsp;]
[&nbsp;<b>sum</b>&nbsp;&nbsp;<a href="atomspec.html"><i>atom-spec2</i></a>&nbsp;]
<blockquote>
Calculate the area of a
<a href="surface.html#surfdefs">solvent-accessible surface</a>
(SAS) enclosing the atoms in &nbsp;<a href="atomspec.html"><i>atom-spec1</i></a>
and report the total value in the <a href="../tools/log.html"><b>Log</b></a>.
The <b>setAttribute</b> option specifies whether to assign the values
per atom and residue as <a href="../attributes.html">attributes</a>
named <b>area</b> (default <b>true</b>).
The <b>sum</b> option can be used to report the
area contribution from some subset of the atoms
(given as &nbsp;<a href="atomspec.html"><i>atom-spec2</i></a>).
The calculated SAS is not displayed. The atoms should be specified with care;
solvent, ions, and ligand residues are not excluded automatically.
Unspecified atoms are ignored, as are atoms in 
&nbsp;<a href="atomspec.html"><i>atom-spec2</i></a> 
that are not also in &nbsp;<a href="atomspec.html"><i>atom-spec1</i></a>.
The default <b>probeRadius</b> <i>rad</i> for calculating the SAS
is <b>1.4</b> &Aring;, often used to approximate a water molecule.
Example:
<blockquote>
<b>measure sasa #1/a & protein sum :phe,tyr,trp</b>
<br>
&ndash; calculate the SAS of the
<a href="atomspec.html#builtin"><b>protein</b></a> in model #1 chain A
and report both the total area and the collective contribution from
phenylalanine, tyrosine, and tryptophan residues
</blockquote>
See also: <a href="#area"><b>measure area</b></a>
</blockquote>

<a href="#top" class="nounder">&bull;</a>
<a name="volume"><b>measure volume</b></a>
&nbsp;<a href="atomspec.html#othermodels"><i>surf-model</i></a>&nbsp;
[&nbsp;<b>includeMasked</b> &nbsp;<b>true</b>&nbsp;|&nbsp;false&nbsp;]
<blockquote>
Report the volume enclosed by an existing surface model.
The <b>includeMasked</b> option controls
whether to include parts of the surface that have been hidden,
such as with <a href="surface.html#dust"><b>surface dust</b></a>
or <a href="surface.html#zone"><b>surface zone</b></a>
(<a href="clip.html">clipping</a> does not affect the measurement, however).
</blockquote>

<a name="notes"></a>
<p class="nav">
[<a href="#top">back to top: surface</a>]
</p>
<h3>Technical Notes</h3>
<p>
<b>Inertia calculation</b>.
<br>
The command <a href="#inertia"><b>measure inertia</b></a>
computes the moments of inertia of a set of atoms as in classical mechanics:
<blockquote>
I<sub>jk</sub> = &Sigma;<sub>i</sub>
(m<sub>i</sub> (&delta;<sub>jk</sub>
|x<sub>i</sub>|<sup>2</sup> &ndash; x<sub>i,j</sub>x<sub>i,k</sub>))
</blockquote>
I is a 3x3 matrix with indices j and k (j=1,2,3 and k=1,2,3).
Each matrix element is a sum over atoms,
where m<sub>i</sub> and x<sub>i</sub> are the mass and position of atom i,
respectively, and &delta;<sub>jk</sub> is 1 for j=k, otherwise 0.
The principal axes are the eigenvectors of the matrix,
and the moments about those axes are the eigenvalues.
Basically, the moment is a sum of mass times distance squared from the
rotation axis. Before this formula is applied, the center of mass
position is subtracted from the atom coordinates,
so that the measured quantity is the inertia about the center of mass.
The approach for surfaces is analogous, where atoms are replaced
by vertices of the triangulated surface, and the &ldquo;mass&rdquo;
of each vertex is &frac13; of the area of the attached triangle.
This treats the surface as a thin shell.
The &ldquo;inertia ellipsoid&rdquo; shown by ChimeraX is not the same
as the one defined in physics. Instead, it is the ellipsoid that has
the same inertia as the measured object:
</p>
<ul>
<li>For atoms, we show the surface of a uniform-density solid ellipsoid
that has the same principal axes and moments as the atoms.
<li>For surfaces, we show an ellipsoidal surface that as a thin shell
has the same axes and moments as the measured surface.
</ul>

<hr>
<address>UCSF Resource for Biocomputing, Visualization, and Informatics / 
May 2019</address>
</body></html>
