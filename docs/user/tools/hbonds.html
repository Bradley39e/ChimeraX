<html>

<!--
=== UCSF ChimeraX Copyright ===
Copyright 2016 Regents of the University of California.
All rights reserved.  This software provided pursuant to a
license agreement containing restrictions on its disclosure,
duplication and use.  For details see:
http://www.rbvi.ucsf.edu/chimerax/docs/licensing.html
This notice must be embedded in or attached to all copies,
including partial copies, of the software or any revisions
or derivations thereof.
=== UCSF ChimeraX Copyright ===
-->

<head>
<link rel="stylesheet" type="text/css" href="../userdocs.css" />
<title>Tool: H-Bonds</title>
</head><body>

<a name="top"></a>
<a href="../index.html">
<img width="60px" src="../ChimeraX-docs-icon.svg" alt="ChimeraX docs icon"
class="clRight" title="User Guide Index"/></a>

<h3><a href="../index.html#tools">Tool</a>: H-Bonds</h3>
<p>
The <b>H-Bonds</b> tool uses <a href="../atomtypes.html">atom types</a> and
<a href="../commands/hbonds.html#criteria">geometric criteria</a>
to identify hydrogen bonds (H-bonds). It is also implemented as the
<a href="../commands/hbonds.html"><b>hbonds</b></a> command.
See also:
<a href="../commands/hbonds.html#related">H-bond-related features</a>,
<a href="distances.html"><b>Distances</b></a>,
<!--
<a href="rotamers.html"><b>Rotamers</b></a>,
-->
<a href="../commands/addh.html"><b>addh</b></a>,
<a href="../commands/clashes.html"><b>clashes</b>/<b>contacts</b></a>,
<a href="../commands/interfaces.html"><b>interfaces</b></a>,
<a href="moldisplay.html"><b>Molecule Display</b></a> icons:
<a href="moldisplay.html" title="Molecule Display Toolbar...">
<img class="icon" border=1 src="shortcut-icons/hbondsflat.png"></a>
<a href="moldisplay.html" title="Molecule Display Toolbar...">
<img class="icon" border=1 src="shortcut-icons/hbondsflathide.png"></a>
</p><p>
<b>H-Bonds</b> can be opened from the <b>Structure Analysis</b> section of the
<b>Tools</b> menu and manipulated like other panels
(<a href="../window.html#panels">more...</a>). 
</p><p>
It is not necessary to add hydrogens first, as their
possible positions will be inferred if they are missing.
The number of H-bonds found is reported in the
<a href="log.html"><b>Log</b></a>.
This number includes all H-bonds consistent with the chosen options,
even if the H-bonds could not coexist simultaneously.
For example, both donor-acceptor and acceptor-donor H-bonds 
could be found between the the same pair of atoms, and a hydroxyl group
could be found to donate a hydrogen bond to two different acceptors even
if only one or the other could be the acceptor at a given time.
If the hydroxyl group has an explicit hydrogen atom,
however, only H-bonds compatible with the position
of the hydrogen will be found.
</p><p>
The calculation can be limited to salt bridges or specified sets of atoms,
and details including endpoint atoms and distances can be written to
a file and/or the <a href="log.html"><b>Log</b></a>.
Clicking <b>Apply</b> (or <b>OK</b>, which also dismisses the dialog)
runs the calculation. Several of the dialog settings are remembered as 
<a href="../preferences.html#other">preferences</a>.
</p><p>
Options:
</p>
<ul>
<li><b>H-bond color</b>
(initial default <b>deep sky blue</b>
<table border cellpadding="4" cellspacing="0"
style="display:inline-block; vertical-align:middle"><tr>
<td bgcolor=deepskyblue width="10px"></td> </tr></table>)
&ndash; color for 
<a href="../pseudobonds.html">pseudobonds</a> representing H-bonds; can be 
changed later with <a href="../commands/color.html#simple"><b>color</b></a>
<p>
A <a href="../pseudobonds.html">pseudobond</a>
is only shown when both of its endpoint atoms are shown; see the option
<a href="#reveal"><b>If endpoint atom hidden...</b></a> below.
H-bond pseudobonds can be removed with the command 
<a href="../commands/hbonds.html"><b>hbonds delete</b></a> or
<a href="../commands/hbonds.html"><b>~hbonds</b></a>.
When there are multiple pseudobond models, specific ones can be
closed using the <a href="modelpanel.html"><b>Model Panel</b></b></a> 
or the <a href="../commands/close.html"><b>close</b></a> command.
</p>
<li><b>Radius</b> (initial default <b>0.075</b> &Aring;)
&ndash; radius for H-bond <a href="../pseudobonds.html">pseudobonds</a>;
can be changed later with <a href="../commands/size.html"><b>size</b></a>
<li><b>Number of dashes</b> (initial default <b>6</b>)
&ndash; number of dashes in H-bond <a href="../pseudobonds.html">pseudobonds</a>;
can be changed later with <a href="../commands/style.html"><b>style</b></a>
<li><b>Label H-bond with distance</b>
(initial default <b>off</b>)
&ndash; whether to show &Aring; distances as bond labels;
the number of decimal places and whether to show the &Aring; symbol can be 
changed with <a href="../commands/distance.html#style"><b>distance style</b></a>
or set beforehand in the
<a href="../preferences.html#distances"><b>Distances</b> preferences</a>,
and label height in &Aring; can be changed with 
<a href="../commands/label.html#height"><b>label height</b></a>
or set beforehand in the
<a href="../preferences.html#labels"><b>Labels</b> preferences</a>
<br><br>
<li><b>Find these bonds</b>:
  <ul>
  <li><b>inter-model</b>
  <li><b>intra-model</b>
  <li><b>both</b> (initial default)
  </ul>
<br>
<li><b>Relax H-bond constraints</b> (initial default <b>on</b>)
&ndash; whether to add tolerance values to the 
<a href="../commands/hbonds.html#criteria">precise criteria</a> for identifying
H-bonds (several different distance and angle cutoffs depending on the 
<a href="../atomtypes.html">atom types</a> involved).
If so, <b>Relax constraints by</b>:
  <ul>
  <li>[<i>distance tolerance</i>] (initial default <b>0.4</b> &Aring;)
  <li>[<i>angle tolerance</i>] (initial default <b>20</b>&deg;)
  <li><b>Color H-bonds not meeting precise criteria differently</b>
&ndash; whether to use a different color for
<a href="../pseudobonds.html">pseudobonds</a> 
representing H-bonds within the tolerance values but not meeting the
<a href="../commands/hbonds.html#criteria">precise criteria</a>
(initial default <b>dark orange</b>
<table border cellpadding="4" cellspacing="0"
style="display:inline-block; vertical-align:middle"><tr>
<td bgcolor=darkorange width="10px" title="dark orange"></td></tr></table>)
  </ul>
<br>
<!--
<li><b>Restrict to models...</b> (initial default <b>off</b>) 
&ndash; choose specific models from the list shown when the option is on
-->
<li><b>Only find H-bonds</b> (initial default <b>off</b>) 
&ndash; whether to limit the results by the current
<a href="../selection.html">selection</a> according to one of the following
choices in the pulldown menu:
  <ul>
  <li><b>with at least one end selected</b>
  <li><b>with exactly one end selected</b>
  <li><b>with both ends selected</b>
  <li><b>between selection and atom spec...</b> 
  [<a href="../commands/atomspec.html"><i>atom-spec</i></a>]
  </ul>
<li><b>Salt bridges only</b> (initial default <b>off</b>) 
<li><b>Include intra-molecule H-bonds</b> (initial default <b>on</b>) 
<li><b>Include intra-residue H-bonds</b> (initial default <b>on</b>) 
<li><a name="reveal"></a><b>If endpoint atom hidden, show endpoint residue</b>
(initial default <b>off</b>) 
<li><b>Retain existing H-bonds</b> (initial default <b>off</b>) 
<li><b>Write information to file</b> (initial default <b>off</b>) 
&ndash; whether to write detailed information to a text file
<li><b>Write information to log</b> (initial default <b>off</b>) 
&ndash; whether to report details (endpoint atoms, distances, <i>etc.</i>)
in the <a href="log.html"><b>Log</b></a>
</ul>
<hr>
<address>UCSF Resource for Biocomputing, Visualization, and Informatics / 
October 2019</address>
</body></html>
